@startuml

' =========================
' Basis-Werteobjekte & Enums
' =========================



enum Rolle {
  LEHRLING
  ANGESTELLTER
  TEAMLEITER
  MANAGER
}

enum FerienArt {
  WUNSCH
  SYSTEM_VORSCHLAG
  BESTAETIGT
}

enum FerienStatus {
  ANGEFRAGT
  GENEHMIGT
  GENERIERT
  ABGELEHNT
  STORNIERT
}

enum Schweregrad {
  KRITISCH
  HOCH
  MITTEL
  NIEDRIG
}

class Qualifikation {
  - name: String
}

' =========================
' Kern-Domäne
' =========================


class JahresPlan {
    - jahr: Int
    - generiertJahresplan(MitarbeiterVerwaltung.Miterarbeiters)
}

object MitarbeiterVerwaltung{
     - Miterarbeiters: Mutiblelist <Mitarbeiter>
     + einfuege()
     + lösche()
     + sucheNachId()
     + sucheNachKuerzel
}

class Mitarbeiter {
  - id: Uint
  - kürzel : String
  - vorname: String
  - nachname: String
  - pensumProzent: Int
  - rolle: Rolle = ANGESTELLTER
  - qualifikationen: List<Qualifikation>
  - ferienEintraege: Mutiblelist<FerienEintrag>
  Mitarbeiter(id, vorname, nachname, pensumProzent)
  + change()
  + generiereFerienantrag()
  + generiereKürzel
}

class FerienEintrag {
  - id: Uint
  - jahr: Int
  - wochenBereich: WochenBereich
  - art: FerienArt
  - status: FerienStatus
  - prioritaet: Int
  - mitarbeiterId: UUID
  - kommentar: String
  + addWochenBereich()
}

class WochenBereich {
  - startWoche: Uint
  - endWoche: Uint
}

object idManager {
    var Ids : List <Int>
    CheckId() : Int
    GeneriereID() : Int
}

' =========================
' Kriterien & Regelwerk
' =========================

interface Kriterium {
  +bewerte(plan: JahresPlan): KriteriumErgebnis
}

class KriteriumKonfiguration {
  - kriterium: Kriterium
  - gewicht: Double
  - aktiviert: Boolean
}

class KriteriumErgebnis {
  - punktzahl: Double
  - regelVerletzungen: List<RegelVerletzung>
}

class RegelVerletzung {
  - id: Uint
  - nachricht: String
  - schweregrad: Schweregrad
  - betroffeneWochen: List<WochenBereich>
  - betroffeneMitarbeiterIds: List<Uint>
}

' Beispiel-Kriterien
class AbdeckungsKriterium
class FairnessKriterium
class QualifikationsKriterium

Kriterium <|.. AbdeckungsKriterium
Kriterium <|.. FairnessKriterium
Kriterium <|.. QualifikationsKriterium

' =========================
' Bewertung & Planung
' =========================

class BewertungsZusammenfassung {
  - gesamtPunktzahl: Double
  - punktzahlProKriterium: Map<String, Double>
  - ergebnisProKriterium: Map<String, KriteriumErgebnis>
}

class PlanBewertung {
  +bewerte(plan: JahresPlan, konfigurationen: List<KriteriumKonfiguration>): BewertungsZusammenfassung
}

class FerienPlaner {
  +erstelleInitialenPlan(jahr: Int, mitarbeiter: List<Mitarbeiter>, konfigurationen: List<KriteriumKonfiguration>): JahresPlan
  +verbesserePlan(plan: JahresPlan, konfigurationen: List<KriteriumKonfiguration>): JahresPlan
  +wendeWuenscheAn(plan: JahresPlan, mitarbeiter: List<Mitarbeiter>): JahresPlan
}

' =========================
' Beziehungen
' =========================

JahresPlan "1" --> "1" MitarbeiterVerwaltung
MitarbeiterVerwaltung "1" --> "1..n " Mitarbeiter
Mitarbeiter "1" --> "1..n "  FerienEintrag
FerienEintrag "1" --> "1"  WochenBereich

KriteriumErgebnis "1" o-- "0..n " RegelVerletzung
BewertungsZusammenfassung "1" o-- "0..n" KriteriumErgebnis
KriteriumKonfiguration "1" o-- "1" Kriterium

PlanBewertung "1" o-- "0..n " KriteriumKonfiguration
PlanBewertung "1" o-- "1" BewertungsZusammenfassung

FerienPlaner "1" o-- "1" PlanBewertung

note right of JahresPlan
  Jahresplan für eine Organisation.
  Mitarbeiterzentriert: Alle Ferien
   werden pro Mitarbeiter gespeichert.
end note

note right of FerienEintrag
  Ferienblock für einen Mitarbeiter.
  Basierend auf Wochenbereichen.
  Erweiterbar auf Tagesbereiche.
end note

note bottom of Kriterium
  Jedes Kriterium liefert:
  - eine Punktzahl für den Optimierungsalgorithmus
  - Regelverletzungen für UI-Feedback
end note

@enduml
