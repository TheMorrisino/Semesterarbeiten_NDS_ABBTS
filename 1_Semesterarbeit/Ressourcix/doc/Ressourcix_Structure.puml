@startuml

' =========================
' Basic Value Objects & Enums
' =========================

class WeekRange {
  - startWeek: Int
  - endWeek: Int
}

enum Role {
  APPRENTICE
  STAFF
  TEAM_LEAD
  MANAGER
}

enum VacationType {
  WISH
  SYSTEM_PROPOSAL
  CONFIRMED
}

enum VacationStatus {
  REQUESTED
  APPROVED
  REJECTED
  CANCELLED
}

enum Severity {
  CRITICAL
  HIGH
  MEDIUM
  LOW
}

class Qualification {
  - name: String
}

' =========================
' Core Domain
' =========================

class Employee {
  - id: UUID
  - firstName: String
  - lastName: String
  - workloadPercent: Int
  - role: Role
  - qualifications: List<Qualification>
  - vacationEntries: List<VacationEntry>
}

class VacationEntry {
  - id: UUID
  - year: Int
  - weekRange: WeekRange
  - type: VacationType
  - status: VacationStatus
  - priority: Int
  - employeeId: UUID
  - comment: String
}

class YearPlan {
  - year: Int
  - employees: List<Employee>
}

' =========================
' Criteria & Rules
' =========================

interface Criterion {
  +evaluate(plan: YearPlan): CriterionResult
}

class CriterionConfig {
  - criterion: Criterion
  - weight: Double
  - enabled: Boolean
}

class CriterionResult {
  - score: Double
  - violations: List<RuleViolation>
}

class RuleViolation {
  - id: UUID
  - message: String
  - severity: Severity
  - affectedWeeks: List<WeekRange>
  - affectedEmployeeIds: List<UUID>
}

' Example concrete criteria (Strategy pattern)
class CoverageCriterion
class FairnessCriterion
class QualificationCriterion

Criterion <|.. CoverageCriterion
Criterion <|.. FairnessCriterion
Criterion <|.. QualificationCriterion

' =========================
' Evaluation & Planning
' =========================

class EvaluationSummary {
  - overallScore: Double
  - perCriterionScore: Map<String, Double>
  - perCriterionResult: Map<String, CriterionResult>
}

class PlanEvaluator {
  +evaluate(plan: YearPlan, configs: List<CriterionConfig>): EvaluationSummary
}

class VacationPlanner {
  +generateInitialPlan(year: Int, employees: List<Employee>, configs: List<CriterionConfig>): YearPlan
  +improvePlan(plan: YearPlan, configs: List<CriterionConfig>): YearPlan
  +applyEmployeeWishes(plan: YearPlan, employees: List<Employee>): YearPlan
}

' =========================
' Relationships
' =========================

YearPlan "1" o-- "*" Employee
Employee "1" o-- "*" VacationEntry
VacationEntry "1" *-- "1" WeekRange

CriterionResult "1" o-- "*" RuleViolation
EvaluationSummary "1" o-- "*" CriterionResult
CriterionConfig "1" o-- "1" Criterion

PlanEvaluator "1" o-- "*" CriterionConfig
PlanEvaluator "1" o-- "1" EvaluationSummary

VacationPlanner "1" o-- "1" PlanEvaluator

note top of YearPlan
  Central yearly plan for the whole organisation.
  Employee-centric: vacations are stored per employee.
end note

note right of VacationEntry
  Immutable domain object (Kotlin data class).
  Later extendable to day-based ranges
  by replacing WeekRange with a date-based type.
end note

note bottom of Criterion
  Each Criterion computes:
  - a score for optimisation
  - a list of rule violations with severity
end note

@enduml
